import os
import matplotlib.pyplot as plt
import numpy as np

# 假设这是从日志中提取的损失值
train_loss = [
    0.7104696246885485, 0.5944551940887205, 0.5399242831814673, 0.49616150894472677,
    0.4617791570002033, 0.4352956721859594, 0.41016539835160776, 0.38945072889328003,
    0.36975391545603353, 0.35084466299703043, 0.33297658351159864, 0.31461635520381315,
    0.3022033158809908, 0.2930802972086014, 0.2839489338859435, 0.27881507479375406,
    0.2719705556669543, 0.26639997286181294, 0.25916129975549634, 0.2564534544944763,
    0.25305306334649363, 0.24786926902109577, 0.2450566065888251, 0.24304446578025818,
    0.24048966746176442, 0.23797732014809886, 0.236634369819395, 0.23556811963358232,
    0.23065833603182145, 0.23002352541492832, 0.22727868633885537, 0.22610090624901555,
    0.22208933436101483, 0.22276061148412765, 0.21995088602266005, 0.22010225105670192,
    0.21933850021131576, 0.21824749054447298, 0.2165092465377623, 0.21544252095683927,
    0.21281813902239646, 0.21172511625674464, 0.21121311235812404, 0.21127154750208701,
    0.21085805277670583, 0.20907997171724996, 0.20671528722009352, 0.20681672519253147,
    0.20624205229743833, 0.20641047147012526, 0.20434059106534527, 0.20302728779854312,
    0.20321893692016602, 0.2012151998858298, 0.202178493142128, 0.20031647816781076,
    0.20049188117827138, 0.19985358753511984, 0.1985912246088828, 0.19802318128847307,
    0.197507597265705, 0.19550260084290658, 0.19576665086130943, 0.1967257011321283,
    0.19664253919355332, 0.19515800860620314, 0.19388706789862725, 0.19288008491839131,
    0.19225870938070358, 0.19351622558409168, 0.1934469452788753, 0.19178024078569106,
    0.19138082477354235, 0.19204878951272658, 0.19153144619157236, 0.1903016423025439,
    0.19121806515801337, 0.1895366080345646, 0.1893069205745574, 0.1897942909309941,
    0.1896401576457485, 0.18829934202855633, 0.18839132545455808, 0.1886319912249042,
    0.18773091368136868, 0.1879443694506922, 0.18686548356086977, 0.18878386001433095,
    0.18768893134209416, 0.18676389657681988, 0.18848443992676273, 0.1891364772473612,
    0.1880878863796111, 0.18711282312870026, 0.18760618519398473, 0.1868969677917419,
    0.18835566024626454, 0.1872343271970749
]

val_loss = [
    0.5945118921143668, 0.567869850567409, 0.4917003725256239, 0.45060537116868155,
    0.3995260383401598, 0.39328862939562115, 0.32919194868632723, 0.3028403988906315,
    0.5033129709107536, 0.296582362481526, 0.3813600369862148, 0.24736249446868896,
    0.23310913358415877, 0.2685413232871464, 0.23266383579799108, 0.22504441014357976,
    0.25628181653363363, 0.22224621900490352, 0.24016896954604558, 0.22563889835562026,
    0.21938000406537736, 0.24259767362049647, 0.22935166103499277, 0.21268201725823538,
    0.21715900940554483, 0.2161679012434823, 0.20878709426948003, 0.24462153230394637,
    0.23324669471808843, 0.2050454786845616, 0.209951394370624, 0.21600790108953202,
    0.2086744670357023, 0.22575261337416513, 0.2065759769507817, 0.20518922167164938,
    0.22650588835988725, 0.20027064212730952, 0.23157737510544912, 0.24906661893640245,
    0.21241760679653712, 0.21473307481833867, 0.22814067772456578, 0.19847897865942546,
    0.22197624615260533, 0.2040632622582572, 0.22169713250228337, 0.20880526091371263,
    0.22064372897148132, 0.2014768591948918, 0.2061369972569602, 0.21717570296355657,
    0.21492799052170344, 0.21799044736794063, 0.21742830957685197, 0.21392289016927993,
    0.21718621253967285, 0.2186147677046912, 0.21728039639336721, 0.21659844475133078,
    0.21708446741104126, 0.21791820866721018, 0.216493798153741, 0.21747592304434096,
    0.21775475995881216
]

# 确保损失列表长度一致（根据实际数据调整）
min_len = min(len(train_loss), len(val_loss))
train_loss = train_loss[:min_len]
val_loss = val_loss[:min_len]

# 创建 plots 目录（如果不存在）
os.makedirs("plots", exist_ok=True)

# 绘制学习曲线
plt.figure(figsize=(10, 6))
plt.plot(train_loss, label="Training Loss", color="blue")
plt.plot(val_loss, label="Validation Loss", color="red")
plt.title("AttUnet-BUSI Training and Validation Loss")
plt.xlabel("Epoch")
plt.ylabel("Loss")
plt.legend()
plt.grid(True)

# 保存图像
plt.savefig("plots/busi_loss_plot.png")
plt.close()

print("学习曲线已保存到 plots/plot.png")