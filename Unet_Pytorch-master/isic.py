import os
import matplotlib.pyplot as plt
import numpy as np

# 假设这是从日志中提取的损失值
train_loss = [
    0.6560, 0.5171, 0.4282, 0.3671, 0.3333, 0.3121, 0.2983, 0.2894, 0.2823, 0.2756,
    0.2699, 0.2653, 0.2603, 0.2568, 0.2528, 0.2490, 0.2454, 0.2425, 0.2399, 0.2378,
    0.2358, 0.2348, 0.2324, 0.2307, 0.2287, 0.2274, 0.2258, 0.2250, 0.2238, 0.2221,
    0.2211, 0.2201, 0.2183, 0.2170, 0.2163, 0.2151, 0.2149, 0.2127, 0.2126, 0.2119,
    0.2108, 0.2101, 0.2092, 0.2087, 0.2073, 0.2070, 0.2064, 0.2053, 0.2043, 0.2038,
    0.2034, 0.2028, 0.2027, 0.2020, 0.2019, 0.2007, 0.2006, 0.2007, 0.2000, 0.1999,
    0.1990, 0.1987, 0.1983, 0.1982, 0.1990, 0.1982, 0.1976, 0.1963, 0.1962, 0.1954,
    0.1955, 0.1958, 0.1946, 0.1942, 0.1928, 0.1929, 0.1931, 0.1926, 0.1931, 0.1921,
    0.1922, 0.1904, 0.1905, 0.1910, 0.1911, 0.1895, 0.1902, 0.1899, 0.1898, 0.1895,
    0.1897, 0.1884, 0.1886, 0.1884, 0.1888, 0.1883, 0.1884, 0.1879, 0.1883, 0.1882
]
val_loss = [
    0.5544, 0.4564, 0.3674, 0.3135, 0.2889, 0.2216, 0.2370, 0.2154, 0.2728, 0.2039,
    0.2118, 0.2517, 0.2241, 0.3657, 0.3138, 0.5797, 0.4825, 0.2633, 0.3694, 0.2984,
    0.3885, 0.1838, 0.3270, 0.1944, 0.2351, 0.1631, 0.1762, 0.1904, 0.1618, 0.1641,
    0.1618, 0.1542, 0.1569, 0.1565, 0.1591, 0.1772, 0.1547, 0.1580, 0.1571, 0.1554,
    0.1623, 0.1580, 0.1583, 0.1575, 0.1582, 0.1628, 0.1523, 0.2052, 0.1514, 0.1685,
    0.1508, 0.1480, 0.1487, 0.1604, 0.1557, 0.1581, 0.1499, 0.1494, 0.1567, 0.1524,
    0.1530, 0.1539, 0.1532, 0.1584, 0.1602, 0.1689, 0.1556, 0.1678, 0.1619, 0.1612,
    0.1659, 0.1745, 0.1737, 0.1741, 0.1668, 0.1725, 0.1620, 0.1632, 0.1635, 0.1637,
    0.1641, 0.1616, 0.1575, 0.1598, 0.1614, 0.1618, 0.1623, 0.1628, 0.1634, 0.1624,
    0.1642, 0.1639, 0.1643, 0.1636, 0.1632, 0.1643, 0.1639, 0.1649, 0.1637, 0.1644
]
# 确保损失列表长度一致（根据实际数据调整）
min_len = min(len(train_loss), len(val_loss))
train_loss = train_loss[:min_len]
val_loss = val_loss[:min_len]

# 创建 plots 目录（如果不存在）
os.makedirs("plots", exist_ok=True)

# 绘制学习曲线
plt.figure(figsize=(10, 6))
plt.plot(train_loss, label="Training Loss", color="blue")
plt.plot(val_loss, label="Validation Loss", color="red")
plt.title("Unet-ISIC Training and Validation Loss")
plt.xlabel("Epoch")
plt.ylabel("Loss")
plt.legend()
plt.grid(True)

# 保存图像
plt.savefig("plots/isic_loss_plot.png")
plt.close()

print("学习曲线已保存到 plots/plot.png")